---
title: RoboCupチームKIKSに参加することにしました
date: 2015-04-11 00:44:00+0900
---

どもども.  
新学期が始まりました. 無事進級したものの, 今年も手強い教科が多そうで大変だなぁって感じです.  
とはいえ, この学校に入学当初本当に学びたかったことであるダイオードやトランジスタといった電子回路の授業が**やっと**[^1]始まりますし, 何故か金曜の午前が空きコマ[^2]なので, なんとかなるといいなぁ.

[^1]: 前年度までは交流回路や電動機といった, (大袈裟に言って)電力会社就職のためみたいな教科が中心だった
[^2]: <https://twitter.com/myon___/status/586332719031984128> <https://twitter.com/myon___/status/586336451228336129>

さて, タイトル通りです.  
先週金曜日より, ウチの学校のRoboCup[^3]チーム[KIKS](http://tnctkiks.boo-log.com/)に参加することを決めました.  
所属はAI班. サーバから送られてくる各ロボットとボールの位置情報を元に, ロボットに指示を出すプログラムを作成したりするところです.

[^3]: <http://en.wikipedia.org/wiki/RoboCup>

READMORE

## 経緯

3年ほど前まで参加していたロボコンで, とある人物から結構酷いことを言われた経験があり, 同じくその人の関わるロボカップには**絶対に参加しないぞ**と決めていました.

しかし先週, 同級生氏からの熱い勧誘があり, "来年以降の卒業などによるメンバー不足が心配だ" とのこと.  
とりあえず見学に行ってみたところ, その日にプロジェクトのソースコードを渡されてしまい断りづらくなってしまったのも一つだったりしますが, 一番の理由は**何らかのグループ開発がしたかった**ことですね.

昨年, Twitterで某氏と "グループ開発しようぜ!" と誘われたわけですが, [その現実はこんなもの](https://twitter.com/myon___/status/578101663510097920)でした.  
結局某氏とは意見が合わず, そのグループとはもう関わるのをやめたわけですが, それでもグループ開発してみたいという思いに変わりはありませんでした.

そんな中こういった勧誘があり, いろいろ思うことはありますがロボカップに参加させてもらうことにしました.  
ロボカップには当時のロボコンメンバーも何人かいて, 少し懐かしい気分でもあります.

## 活動内容

メンバー不足が心配で呼ばれたとはいえ, 時期的な都合からすぐ本格的な活動に参加することはできません.  
そもそも現時点で僕がロボカップのルール等に関してよくわかっていない部分が多かったり, 開発言語が**Windowsの関数やMFCに依存しまくったVC++**[^4]だったり, ソースコードもメンバーから**ロボカップ語**と恐れられているようなものだったりするので, 結局のところすぐに開発に参加するのは難しいわけです.

[^4]: 今週僕がVisual Studioと格闘しまくっていたのはこのためです

そこで, とりあえず**ソースコード全体の把握**を兼ねた**リファクタリング**をさせてもらうことにしました.

上に**ロボカップ語**と書きましたが, このAIのプログラムは**電気科の人間**によって**少なくとも2005年から維持/メンテされている**ものであり, それは予想以上に悲惨なものでした.  
こんなのはその一部に過ぎません.

<blockquote class="twitter-tweet tw-align-center" lang="en"><p>なんかgrepが効かないと思ったら, 全部cp932なファイルだった時の顔してる</p>&mdash; とさいぬ (@myon\_\_\_) <a href="https://twitter.com/myon___/status/583868618712027137">April 3, 2015</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<blockquote class="twitter-tweet tw-align-center" lang="en"><p>プロジェクトのほぼ全てに影響するヘッダファイルでusing namespace std;されてる案件って本当に存在するんだなー()</p>&mdash; とさいぬ (@myon\_\_\_) <a href="https://twitter.com/myon___/status/583926303859937280">April 3, 2015</a></blockquote>

<blockquote class="twitter-tweet tw-align-center" lang="en"><p>例のプロジェクトのヘッダファイルに書かれたusing namespace std;を興味本位でコメントアウトしたところ, 案の定20,000のエラーが出た.</p>&mdash; とさいぬ (@myon\_\_\_) <a href="https://twitter.com/myon___/status/585787255748296704">April 8, 2015</a></blockquote>

こんな感じのもどかしい気分になるコードが沢山あり, すごくリファクタリングし甲斐ありそうです.

```cpp
bool IsValid() {
  if (flag) {
    return false;
  } else {
    return true;
  }
}
// => return !flag; でよくね?
```

```cpp
// それなりにサイズの大きそうなクラスのコピー渡し
void Hoge(vector<Foo> v);
```

```cpp

class Myon {
  map<char, CString> m_Map;

public:
  Myon()
  {
    m_Map.insert(make_pair('A', (CString)"Foo"));
    m_Map.insert(make_pair('B', (CString)"Bar"));
    m_Map.insert(make_pair('C', (CString)"Baz"));
    // あと70行くらい続く
  }
};
```

VC++とはいえ, 幸いなことにMSVC12な環境なのである程度最新のC++の機能が使えます. 他メンバーの開発に影響のない程度にモダンなものに書き換えれたらなと思っています.  
また, Git管理されていたのも嬉しかったですね.

さてさて, 勉強 + ロボカップで相当忙しい1年になりそうですが, まぁ頑張りたいと思います.  
ではではー
